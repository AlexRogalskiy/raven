{"version":3,"sources":["webpack:///transfer.js","webpack:///webpack/bootstrap f73b7620f4d3814a64b4","webpack:///./src/store.ts","webpack:///./src/transfer.ts"],"names":["this","modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","3","__extends","extendStatics","setPrototypeOf","__proto__","Array","b","__","constructor","create","value","stringify","JSON","Storage","data","setItem","key","getItem","removeItem","clear","realStorage","Store","type","_storage","keys","bindRealStorage","storage","set","indexOf","push","parse","has","remove","index","splice","merge","source","toJS","_i","_a","length","CollectionStore","_super","_this","apply","arguments","collect","item","current","_update","pop","shift","unshift","collection","5","duplex","store_1","Transfer","transferFunc","queue","running","configStore","transfer","config","keyOrObject","value_1","send","message","sent","callback","extendMessage","err","run","default"],"mappings":"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","file":"transfer.js","sourcesContent":["this[\"transfer\"] =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 5);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar stringify = JSON.stringify;\r\nvar Storage = (function () {\r\n    function Storage() {\r\n        this.data = {};\r\n    }\r\n    Storage.prototype.setItem = function (key, value) {\r\n        this.data[key] = value;\r\n    };\r\n    Storage.prototype.getItem = function (key) {\r\n        var value = this.data[key];\r\n        return value;\r\n    };\r\n    Storage.prototype.removeItem = function (key) {\r\n        delete this.data[key];\r\n    };\r\n    Storage.prototype.clear = function () {\r\n        this.data = {};\r\n    };\r\n    return Storage;\r\n}());\r\nexports.Storage = Storage;\r\nvar realStorage = null;\r\nvar Store = (function () {\r\n    function Store(name) {\r\n        this.type = Store;\r\n        this._storage = new Storage();\r\n        this.keys = [];\r\n        this.name = name;\r\n    }\r\n    Store.bindRealStorage = function (storage) {\r\n        realStorage = storage;\r\n    };\r\n    Object.defineProperty(Store.prototype, \"storage\", {\r\n        get: function () {\r\n            if (realStorage) {\r\n                return realStorage;\r\n            }\r\n            else {\r\n                return this._storage;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Store.prototype.set = function (key, value) {\r\n        this.storage.setItem(this.name + \":\" + key, stringify(value));\r\n        if (this.keys.indexOf(key) === -1) {\r\n            this.keys.push(key);\r\n        }\r\n        return value;\r\n    };\r\n    Store.prototype.get = function (key) {\r\n        var value = this.storage.getItem(this.name + \":\" + key);\r\n        if (value) {\r\n            return JSON.parse(value);\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    Store.prototype.has = function (key) {\r\n        return this.keys.indexOf(key) >= 0;\r\n    };\r\n    Store.prototype.remove = function (key) {\r\n        this.storage.removeItem(this.name + \":\" + key);\r\n        var index = this.keys.indexOf(key);\r\n        if (index >= 0) {\r\n            this.keys.splice(index, 1);\r\n        }\r\n    };\r\n    Store.prototype.clear = function () {\r\n        this.storage.clear();\r\n        this.keys = [];\r\n    };\r\n    Store.prototype.merge = function (source) {\r\n        for (var key in source) {\r\n            if (source.hasOwnProperty(key)) {\r\n                var value = source[key];\r\n                this.set(key, value);\r\n            }\r\n        }\r\n    };\r\n    Store.prototype.toJS = function () {\r\n        var object = {};\r\n        for (var _i = 0, _a = this.keys; _i < _a.length; _i++) {\r\n            var key = _a[_i];\r\n            object[key] = this.get(key);\r\n        }\r\n        return object;\r\n    };\r\n    return Store;\r\n}());\r\nexports.Store = Store;\r\nvar CollectionStore = (function (_super) {\r\n    __extends(CollectionStore, _super);\r\n    function CollectionStore() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.type = CollectionStore;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(CollectionStore.prototype, \"length\", {\r\n        get: function () {\r\n            return this.collect().length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CollectionStore.prototype.collect = function () {\r\n        return this.get('collection') || [];\r\n    };\r\n    CollectionStore.prototype.push = function (item) {\r\n        var current = this.collect();\r\n        current.push(item);\r\n        this._update(current);\r\n        return current.length;\r\n    };\r\n    CollectionStore.prototype.pop = function () {\r\n        var current = this.collect();\r\n        var item = current.pop();\r\n        this._update(current);\r\n        return item;\r\n    };\r\n    CollectionStore.prototype.shift = function () {\r\n        var current = this.collect();\r\n        var item = current.shift();\r\n        this._update(current);\r\n        return item;\r\n    };\r\n    CollectionStore.prototype.unshift = function (item) {\r\n        var current = this.collect();\r\n        current.unshift(item);\r\n        this._update(current);\r\n        return current.length;\r\n    };\r\n    CollectionStore.prototype._update = function (collection) {\r\n        this.set('collection', collection);\r\n        this.set('length', collection.length);\r\n    };\r\n    return CollectionStore;\r\n}(Store));\r\nexports.CollectionStore = CollectionStore;\r\n\n\n/***/ }),\n\n/***/ 5:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar store_1 = __webpack_require__(3);\r\nvar Transfer = (function () {\r\n    function Transfer(name, transferFunc) {\r\n        if (transferFunc === void 0) { transferFunc = duplex; }\r\n        this.queue = [];\r\n        this.running = false;\r\n        this.name = name;\r\n        this.configStore = new store_1.Store(\"transfer:\" + name);\r\n        this.transfer = transferFunc;\r\n    }\r\n    Transfer.prototype.config = function (keyOrObject, value) {\r\n        if (typeof keyOrObject === 'string') {\r\n            var key = keyOrObject;\r\n            this.configStore.set(key, value);\r\n        }\r\n        else {\r\n            for (var key in keyOrObject) {\r\n                if (keyOrObject.hasOwnProperty(key)) {\r\n                    var value_1 = keyOrObject[key];\r\n                    this.config(key, value_1);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Transfer.prototype.send = function (message) {\r\n        var _this = this;\r\n        var data = message.data, sent = message.sent;\r\n        this.queue.push(function (callback) {\r\n            _this.transfer.call(_this, _this.extendMessage(data), function (err) {\r\n                if (err) {\r\n                    return callback(err);\r\n                }\r\n                message.sent = true;\r\n                callback();\r\n            });\r\n        });\r\n        if (!this.running) {\r\n            this.run();\r\n        }\r\n    };\r\n    Transfer.prototype.extendMessage = function (message) {\r\n        if (this.configStore.has('user')) {\r\n            message['user'] = this.configStore.get('user');\r\n        }\r\n        if (this.configStore.has('tags')) {\r\n            message['tags'] = this.configStore.get('tags');\r\n        }\r\n        if (this.configStore.has('extra')) {\r\n            message['extra'] = this.configStore.get('extra');\r\n        }\r\n        if (this.configStore.has('release')) {\r\n            message['release'] = this.configStore.get('release');\r\n        }\r\n        if (this.configStore.has('environment')) {\r\n            message['environment'] = this.configStore.get('environment');\r\n        }\r\n        return message;\r\n    };\r\n    Transfer.prototype.run = function () {\r\n        var _this = this;\r\n        var current = this.queue.splice(0, 1)[0]; // .shift()\r\n        if (current) {\r\n            this.running = true;\r\n            current(function () { return _this.run(); });\r\n        }\r\n        else {\r\n            this.running = false;\r\n        }\r\n    };\r\n    return Transfer;\r\n}());\r\nexports.default = Transfer;\r\nfunction duplex(value) { return value; }\r\n\n\n/***/ })\n\n/******/ });\n\n\n// WEBPACK FOOTER //\n// transfer.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f73b7620f4d3814a64b4","const stringify = JSON.stringify\n\nexport type ValidKeyType = string | symbol\nexport type ValidValueType = string | number | symbol | boolean | any[] | any\n\nexport class Storage {\n  data: { [key: string]: ValidValueType } = {}\n  \n  setItem(key: ValidKeyType, value: ValidValueType) {\n    this.data[key] = value\n  }\n\n  getItem(key: ValidKeyType) {\n    const value = this.data[key]\n\n    return value\n  }\n\n  removeItem(key: ValidKeyType) {\n    delete this.data[key]\n  }\n\n  clear() {\n    this.data = {}\n  }\n}\n\nlet realStorage = null\n\nexport class Store {\n\n  type = Store\n\n  _storage?: any = new Storage()\n  name: string\n  keys: ValidKeyType[] = []\n\n  constructor(name: string) {\n    this.name = name\n  }\n\n  static bindRealStorage(storage: any) {\n    realStorage = storage\n  }\n\n  get storage() {\n    if (realStorage) {\n      return realStorage\n    } else {\n      return this._storage\n    }\n  }\n\n  set(key: ValidKeyType, value: ValidValueType) {\n    this.storage.setItem(`${this.name}:${key}`, stringify(value))\n\n    if (this.keys.indexOf(key) === -1) {\n      this.keys.push(key)\n    }\n\n    return value\n  }\n\n  get(key: ValidKeyType) {\n    const value = this.storage.getItem(`${this.name}:${key}`)\n    if (value) {\n      return JSON.parse(value)\n    } else {\n      return null\n    }\n  }\n\n  has(key: ValidKeyType) {\n    return this.keys.indexOf(key) >= 0\n  }\n\n  remove(key: ValidKeyType) {\n    this.storage.removeItem(`${this.name}:${key}`)\n    \n    const index = this.keys.indexOf(key)\n    if (index >= 0) {\n      this.keys.splice(index, 1)\n    }\n  }\n\n  clear() {\n    this.storage.clear()\n    this.keys = []\n  }\n\n  merge(source: any) {\n    for (const key in source) {\n      if (source.hasOwnProperty(key)) {\n        const value = source[key]\n        \n        this.set(key, value)\n      }\n    }\n  }\n\n  toJS() {\n    const object: any = {}\n    \n    for (const key of this.keys) {\n      object[key] = this.get(key)\n    }\n\n    return object\n  }\n}\n\nexport class CollectionStore<T> extends Store {\n\n  type = CollectionStore\n\n  get length() {\n    return this.collect().length\n  }\n\n  collect(): T[] {\n    return this.get('collection') || []\n  }\n\n  push(item: T) {\n    const current = this.collect()\n\n    current.push(item)\n\n    this._update(current)\n    return current.length\n  }\n\n  pop() {\n    const current = this.collect()\n    const item = current.pop()\n\n    this._update(current)\n\n    return item\n  }\n\n  shift() {\n    const current = this.collect()\n    const item = current.shift()\n\n    this._update(current)\n\n    return item\n  }\n\n  unshift(item: T) {\n    const current = this.collect()\n\n    current.unshift(item)\n\n    this._update(current)\n    return current.length\n  }\n\n  _update(collection) {\n    this.set('collection', collection)\n    this.set('length', collection.length)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/store.ts","import { Store } from './store'\nimport { IMessage } from './messages-store'\nimport { ISourceMessage } from './source'\n\nexport type Callback = (error?: Error, reason?: any) => void\nexport type TransferFunc = (data?: any, callback?: Callback) => void\n\nexport default class Transfer {\n\n  name: string\n  transfer?: TransferFunc\n  configStore: Store\n\n  queue: TransferFunc[] = []\n  running = false\n\n  constructor(name: string, transferFunc: TransferFunc = duplex) {\n    this.name = name\n    this.configStore = new Store(`transfer:${name}`)\n    this.transfer = transferFunc\n  }\n\n  config(key: string, value: string)\n  config(object: any)\n\n  config(keyOrObject: any, value?: string) {\n    if (typeof keyOrObject === 'string') {\n      const key: string = keyOrObject\n\n      this.configStore.set(key, value)\n    } else {\n      for (const key in keyOrObject) {\n        if (keyOrObject.hasOwnProperty(key)) {\n          const value = keyOrObject[key]\n          \n          this.config(key, value)\n        }\n      }\n    }\n  }\n\n  send(message: IMessage) {\n    const { data, sent } = message\n    this.queue.push((callback: Callback) => {\n      this.transfer.call(this, this.extendMessage(data), (err: Error) => {\n        if (err) {\n          return callback(err)\n        }\n\n        message.sent = true\n        callback()\n      })\n    })\n\n    if (!this.running) {\n      this.run()\n    }\n  }\n\n  extendMessage(message: ISourceMessage) {\n    if (this.configStore.has('user')) {\n      message['user'] = this.configStore.get('user')\n    }\n\n    if (this.configStore.has('tags')) {\n      message['tags'] = this.configStore.get('tags')\n    }\n\n    if (this.configStore.has('extra')) {\n      message['extra'] = this.configStore.get('extra')\n    }\n\n    if (this.configStore.has('release')) {\n      message['release'] = this.configStore.get('release')\n    }\n\n    if (this.configStore.has('environment')) {\n      message['environment'] = this.configStore.get('environment')\n    }\n\n    return message\n  }\n\n  run() {\n    const current = this.queue.splice(0, 1)[0] // .shift()\n\n    if (current) {\n      this.running = true\n\n      current(() => this.run())\n    } else {\n      this.running = false\n    }\n  }\n\n}\n\nfunction duplex(value) { return value }\n\n\n\n// WEBPACK FOOTER //\n// ./src/transfer.ts"],"sourceRoot":""}